<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RBXM → Toolbox Converter</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

  <!-- Galaxy Background -->
  <div class="galaxy-bg">
    <canvas id="starsCanvas"></canvas>
    <div class="nebula n1"></div>
    <div class="nebula n2"></div>
    <div class="nebula n3"></div>
    <div class="nebula n4"></div>
  </div>

  <!-- Help Modal -->
  <div class="modal-overlay" id="helpModal">
    <div class="modal glass-card">
      <div class="modal-header">
        <h2><i class="fas fa-life-ring"></i> Help Center</h2>
        <button class="modal-close-btn" onclick="closeHelp()"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="help-nav">
          <button class="help-nav-btn active" data-tab="guide"><i class="fas fa-book-open"></i> Guide</button>
          <button class="help-nav-btn" data-tab="apikey"><i class="fas fa-key"></i> API Key</button>
          <button class="help-nav-btn" data-tab="userid"><i class="fas fa-id-card"></i> User ID</button>
          <button class="help-nav-btn" data-tab="faq"><i class="fas fa-question"></i> FAQ</button>
        </div>

        <!-- Guide Tab -->
        <div class="help-panel active" id="panel-guide">
          <div class="guide-flow">
            <div class="flow-step">
              <div class="flow-num">1</div>
              <div class="flow-body">
                <h4>Get Your API Key</h4>
                <p>Create an Open Cloud API key from Roblox Creator Dashboard with <strong>Assets API</strong> permissions (Read + Write).</p>
              </div>
            </div>
            <div class="flow-line"></div>
            <div class="flow-step">
              <div class="flow-num">2</div>
              <div class="flow-body">
                <h4>Verify Your Identity</h4>
                <p>Enter your <strong>Roblox User ID</strong> or <strong>Group ID</strong> and click verify. We'll confirm it exists and show your profile.</p>
              </div>
            </div>
            <div class="flow-line"></div>
            <div class="flow-step">
              <div class="flow-num">3</div>
              <div class="flow-body">
                <h4>Validate API Key</h4>
                <p>We test your API key against the Roblox API to make sure it has correct permissions and IP whitelisting.</p>
              </div>
            </div>
            <div class="flow-line"></div>
            <div class="flow-step">
              <div class="flow-num">4</div>
              <div class="flow-body">
                <h4>Upload RBXM File</h4>
                <p>Drag & drop or click to select your <strong>.rbxm</strong> or <strong>.rbxmx</strong> model file (max 50MB).</p>
              </div>
            </div>
            <div class="flow-line"></div>
            <div class="flow-step">
              <div class="flow-num">5</div>
              <div class="flow-body">
                <h4>Get Your Asset ID</h4>
                <p>After upload, you receive the <strong>Asset ID</strong>, <strong>Toolbox URL</strong>, and <strong>rbxassetid://</strong> link ready to use in Studio!</p>
              </div>
            </div>
          </div>
        </div>

        <!-- API Key Tab -->
        <div class="help-panel" id="panel-apikey">
          <div class="info-card warning-card">
            <i class="fas fa-shield-alt"></i>
            <div>
              <h4>Your Key = Your Responsibility</h4>
              <p>Each user must use their <strong>own personal API key</strong>. Keys are stored only in YOUR browser's localStorage. We never store or log API keys on the server.</p>
            </div>
          </div>

          <div class="steps-list">
            <div class="step-item">
              <span class="step-badge">1</span>
              <div>
                <h4>Open Creator Dashboard</h4>
                <p>Go to <a href="https://create.roblox.com/dashboard/credentials" target="_blank" class="link">create.roblox.com/dashboard/credentials</a></p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-badge">2</span>
              <div>
                <h4>Click "CREATE API KEY"</h4>
                <p>Give it a name like "RBXM Converter"</p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-badge">3</span>
              <div>
                <h4>Add "Assets" API System</h4>
                <p>Enable both <strong>Read</strong> and <strong>Write</strong> operations</p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-badge">4</span>
              <div>
                <h4>Set Accepted IP Addresses</h4>
                <p>Add your server's IP, or use <code>0.0.0.0/0</code> to allow all (for testing)</p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-badge">5</span>
              <div>
                <h4>Copy & Save Immediately</h4>
                <p>You can only see the key <strong>once</strong> after creation. Copy it now!</p>
              </div>
            </div>
          </div>

          <div class="info-card danger-card">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
              <h4>Never Share Your API Key</h4>
              <p>Anyone with your key can upload assets to your account. Keep it private.</p>
            </div>
          </div>
        </div>

        <!-- User ID Tab -->
        <div class="help-panel" id="panel-userid">
          <div class="id-method">
            <div class="id-icon"><i class="fas fa-user"></i></div>
            <div>
              <h4>Finding Your User ID</h4>
              <p>Go to your Roblox profile. The number in the URL is your User ID:</p>
              <div class="code-block">https://www.roblox.com/users/<span class="hl">123456789</span>/profile</div>
              <p class="sub">Or visit <a href="https://www.roblox.com/my/account" target="_blank" class="link">roblox.com/my/account</a></p>
            </div>
          </div>

          <div class="id-method">
            <div class="id-icon group"><i class="fas fa-users"></i></div>
            <div>
              <h4>Finding Your Group ID</h4>
              <p>Go to your group page. The number in the URL is the Group ID:</p>
              <div class="code-block">https://www.roblox.com/groups/<span class="hl">7654321</span>/GroupName</div>
            </div>
          </div>

          <div class="info-card info-blue">
            <i class="fas fa-info-circle"></i>
            <div>
              <h4>Verification Required</h4>
              <p>This tool verifies your User/Group ID with Roblox API before allowing uploads. This ensures you're uploading to a real, active account.</p>
            </div>
          </div>
        </div>

        <!-- FAQ Tab -->
        <div class="help-panel" id="panel-faq">
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> What files can I upload?</div>
            <p>.rbxm (binary) and .rbxmx (XML) Roblox model files, up to 50MB.</p>
          </div>
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> Is my API key safe?</div>
            <p>Yes. Your key is stored only in your browser's localStorage. The server uses it only for the single upload request and never saves it.</p>
          </div>
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> Why does verification fail?</div>
            <p>Make sure the User/Group ID is correct, the account isn't banned, and the group isn't locked.</p>
          </div>
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> Upload failed with 403?</div>
            <p>Your API key's IP whitelist doesn't include this server's IP. Add the server IP or use 0.0.0.0/0.</p>
          </div>
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> Can I upload to someone else's account?</div>
            <p>No. You need that account's API key. Each person uses their own key.</p>
          </div>
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> Where does the asset appear?</div>
            <p>In your Roblox Inventory > Models, and searchable via the Toolbox in Roblox Studio.</p>
          </div>
          <div class="faq-item">
            <div class="faq-q"><i class="fas fa-chevron-right"></i> The upload is stuck on "processing"?</div>
            <p>Large models can take up to 60 seconds. If it times out, check your Roblox inventory - it may have uploaded successfully.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div class="app-wrapper">
    <header class="app-header">
      <div class="header-left">
        <div class="logo-cube">
          <i class="fas fa-cube"></i>
          <div class="cube-glow"></div>
        </div>
        <div>
          <h1 class="logo-title">RBXM <span class="grad">Converter</span></h1>
          <p class="logo-sub">Upload RBXM → Get Toolbox Asset ID</p>
        </div>
      </div>
      <button class="help-trigger glass-btn" onclick="openHelp()">
        <i class="fas fa-question-circle"></i>
        <span>Help</span>
      </button>
    </header>

    <main class="app-main">

      <!-- STEP 1: Identity Verification -->
      <section class="card glass-card anim-up" style="--d:0.1s">
        <div class="card-head">
          <div class="card-icon"><i class="fas fa-user-check"></i></div>
          <div>
            <h2>Step 1: Verify Identity</h2>
            <p class="card-desc">Confirm your Roblox account before uploading</p>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group grow">
            <label><i class="fas fa-id-badge"></i> Creator ID <span class="req">*</span></label>
            <input type="text" id="creatorId" class="glass-input" placeholder="Enter User ID or Group ID...">
          </div>
          <div class="form-group shrink">
            <label><i class="fas fa-tag"></i> Type</label>
            <select id="creatorType" class="glass-input glass-select">
              <option value="User">User</option>
              <option value="Group">Group</option>
            </select>
          </div>
        </div>

        <button class="action-btn verify-btn" id="verifyBtn" onclick="verifyCreator()">
          <i class="fas fa-search"></i>
          <span>Verify ID</span>
          <div class="btn-shine"></div>
        </button>

        <!-- Profile Card (shown after verification) -->
        <div class="profile-card" id="profileCard" style="display:none">
          <img id="profileAvatar" class="profile-avatar" src="" alt="Avatar">
          <div class="profile-info">
            <div class="profile-name" id="profileName"></div>
            <div class="profile-username" id="profileUsername"></div>
            <div class="profile-meta" id="profileMeta"></div>
          </div>
          <div class="profile-badge" id="profileBadge">
            <i class="fas fa-check-circle"></i> Verified
          </div>
        </div>

        <div id="verifyStatus" class="status-msg"></div>
      </section>

      <!-- STEP 2: API Key -->
      <section class="card glass-card anim-up" style="--d:0.2s" id="apiSection">
        <div class="card-head">
          <div class="card-icon"><i class="fas fa-key"></i></div>
          <div>
            <h2>Step 2: Your API Key</h2>
            <p class="card-desc">Enter your personal Open Cloud API key</p>
          </div>
        </div>

        <div class="info-card security-card">
          <i class="fas fa-lock"></i>
          <p>Your API key is stored <strong>only in your browser</strong>. We never save or log it on our servers. Each user must use their own key.</p>
        </div>

        <div class="form-group">
          <label><i class="fas fa-key"></i> Open Cloud API Key <span class="req">*</span></label>
          <div class="input-wrap">
            <input type="password" id="apiKey" class="glass-input" placeholder="Paste your API key here..." autocomplete="off">
            <button class="input-icon-btn" id="eyeBtn" onclick="toggleEye()"><i class="fas fa-eye"></i></button>
          </div>
          <div class="form-hint"><i class="fas fa-external-link-alt"></i> Get from <a href="https://create.roblox.com/dashboard/credentials" target="_blank" class="link">Creator Dashboard</a></div>
        </div>

        <button class="action-btn validate-btn" onclick="validateApiKey()">
          <i class="fas fa-check-double"></i>
          <span>Validate Key</span>
          <div class="btn-shine"></div>
        </button>

        <div id="keyStatus" class="status-msg"></div>
      </section>

      <!-- STEP 3: File Upload -->
      <section class="card glass-card anim-up" style="--d:0.3s">
        <div class="card-head">
          <div class="card-icon"><i class="fas fa-cloud-upload-alt"></i></div>
          <div>
            <h2>Step 3: Upload File</h2>
            <p class="card-desc">Select your RBXM model file</p>
          </div>
        </div>

        <div class="drop-zone" id="dropZone">
          <div class="drop-content">
            <div class="drop-icon"><i class="fas fa-cloud-upload-alt"></i></div>
            <h3>Drag & Drop RBXM File</h3>
            <p>or click to browse</p>
            <div class="drop-badges">
              <span class="badge">.rbxm</span>
              <span class="badge">.rbxmx</span>
              <span class="badge">Max 50MB</span>
            </div>
          </div>
          <input type="file" id="fileInput" accept=".rbxm,.rbxmx" hidden>
        </div>

        <div class="file-preview" id="filePreview" style="display:none">
          <div class="fp-icon"><i class="fas fa-file-code"></i></div>
          <div class="fp-info">
            <span class="fp-name" id="fpName"></span>
            <span class="fp-size" id="fpSize"></span>
          </div>
          <button class="fp-remove" onclick="clearFile()"><i class="fas fa-trash-alt"></i></button>
        </div>
      </section>

      <!-- STEP 4: Asset Details -->
      <section class="card glass-card anim-up" style="--d:0.4s">
        <div class="card-head">
          <div class="card-icon"><i class="fas fa-pen-fancy"></i></div>
          <div>
            <h2>Step 4: Asset Details</h2>
            <p class="card-desc">Name and describe your model</p>
          </div>
        </div>

        <div class="form-group">
          <label><i class="fas fa-heading"></i> Asset Name</label>
          <input type="text" id="assetName" class="glass-input" placeholder="My Awesome Model" maxlength="50">
          <div class="char-count"><span id="nameLen">0</span>/50</div>
        </div>

        <div class="form-group">
          <label><i class="fas fa-align-left"></i> Description</label>
          <textarea id="assetDesc" class="glass-input glass-textarea" placeholder="Optional description..." maxlength="1000" rows="3"></textarea>
          <div class="char-count"><span id="descLen">0</span>/1000</div>
        </div>
      </section>

      <!-- Convert Button -->
      <div class="convert-wrap anim-up" style="--d:0.5s">
        <button class="mega-btn" id="megaBtn" onclick="doConvert()">
          <div class="mega-bg"></div>
          <div class="mega-inner">
            <i class="fas fa-rocket"></i>
            <span>Convert & Upload to Roblox</span>
          </div>
          <div class="mega-shine"></div>
        </button>
      </div>

      <!-- Progress -->
      <section class="card glass-card" id="progressCard" style="display:none">
        <div class="progress-wrap">
          <div class="prog-spinner">
            <svg viewBox="0 0 50 50"><circle cx="25" cy="25" r="20"></circle></svg>
            <div class="prog-icon"><i class="fas fa-cog fa-spin"></i></div>
          </div>
          <h3 id="progTitle">Uploading...</h3>
          <p id="progText">Sending your file to Roblox</p>
          <div class="prog-bar"><div class="prog-fill" id="progFill"></div></div>
          <div class="prog-percent" id="progPercent">0%</div>
        </div>
      </section>

      <!-- Result -->
      <section class="card glass-card" id="resultCard" style="display:none">
        <div class="result-wrap">
          <div class="result-icon" id="resultIcon"><i class="fas fa-check-circle"></i></div>
          <h3 id="resTitle">Success!</h3>
          <p id="resMsg"></p>

          <div class="result-grid" id="resultGrid" style="display:none">
            <div class="res-item">
              <label>Asset ID</label>
              <div class="res-row">
                <span class="res-val" id="resAssetId"></span>
                <button class="copy-btn" onclick="copyText('resAssetId')"><i class="fas fa-copy"></i></button>
              </div>
            </div>
            <div class="res-item">
              <label>Toolbox URL</label>
              <div class="res-row">
                <a class="res-link" id="resToolbox" href="#" target="_blank"></a>
                <button class="copy-btn" onclick="copyText('resToolbox')"><i class="fas fa-copy"></i></button>
              </div>
            </div>
            <div class="res-item">
              <label>Studio ID</label>
              <div class="res-row">
                <span class="res-val" id="resStudio"></span>
                <button class="copy-btn" onclick="copyText('resStudio')"><i class="fas fa-copy"></i></button>
              </div>
            </div>
          </div>

          <button class="action-btn reset-btn" onclick="resetAll()">
            <i class="fas fa-redo-alt"></i>
            <span>Convert Another</span>
          </button>
        </div>
      </section>

    </main>

    <footer class="app-footer">
      <p>Built with <i class="fas fa-heart beat"></i> for Roblox Developers &bull; Each user uses their own API key</p>
    </footer>
  </div>

  <div class="toast-stack" id="toastStack"></div>

  <script src="script.js"></script>
</body>
</html>
